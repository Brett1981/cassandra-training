<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>C* Primer: Part 01 - Cassandra and Modelling Basics</title>

		<meta name="description" content="A presentation to give insight into the basics of C* and data modelling">
		<meta name="author" content="Christopher Reedijk | Gary Stewart">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/night.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Include the appropriate print stylesheet -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
		<style type="text/css">
        .ING {
        	color: #ff6600;
        }
        .ING_DARK_BLUE {
        	color: #000066;
        }
        .ING_LIGHT_BLUE {
        	color: #B4C3E1;
        }
        .ING_GREY {
        	color: #969696;
        }
        .ING_DARK_GREY {
        	color: #5F5F5F;
        }
		.reveal table {
			margin: auto;
			border-collapse: collapse;
			border-spacing: 0; }

		.reveal table th {
			font-weight: bold; }

		.reveal table th,
		.reveal table td {
			text-align: left;
			padding: 0.2em 0.5em 0.2em 0.5em;
			border-bottom: none; }

		.reveal table tr:last-child td {
			border-bottom: none; }
    </style>
    <link rel="shortcut icon" href="./images/ing_nl_favicon.ico">
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>				
					<section>
						<h1><scan class="ING">C* Primer</scan></h1>					
						<h3>Part 01: Cassandra and Modeling Basics</h3>
						<p>
							<!--<small>Created by Christopher Reedijk (<a href="http://twitter.com/creedijk"><span class="ING">@creedijk</span></a>) and Gary Stewart (<a href="http://twitter.com/Gaz_GandA"><span class="ING">@Gaz_GandA</span></a>)<br>Dev Engineers, ING Netherlands</small><br>-->
							<pre><code class="sql" data-trim contenteditable style="font-size: 18px;">
	SELECT * FROM presenters WHERE name IN ('Christopher Reedijk', 'Gary Stewart');
	 name                | title        | company | area | twitter    
	---------------------+--------------+---------+------+----------- 
	 Christopher Reedijk | Dev Engineer | ING     | NL   | @creedijk
	 Gary Stewart        | Dev Engineer | ING     | NL   | @Gaz_GandA
	 						</code></pre>
							<br><img width=10% src="./images/ing_nl.jpg" alt="ING">
							<br><small>ING Nederland (<a href="http://twitter.com/@ingnl"><span class="ING">@ingnl</span></a>)</small>
							<br><br><br><small>This presentation is based on a 101 presentation by<br>Hayato Shimizu (<a href="https://twitter.com/hayato_shimizu"><span class="ING">@hayato_shimizu</span></a>)</small>
						</p>
					</section>				
					<section>
						<p><span class="ING">Short introduction</span></p>
	                    	<table width="100%" height="95%">
	                    		<tr>
	                    			<td height="10%" style="text-align:center;vertical-align:top"><em>a little bit about us</em></td>
	                    		</tr>
	                    		<tr>
	                    			<td height="90%" style="text-align:center;color:#ff6600;vertical-align:middle">
	                    				<table>
											<tr>
												<td width=50% style="text-align:center"><img width="150" height="200" src="./images/gary_social.jpg" alt="Gary"></td>
												<td width=50% style="text-align:center"><img width="150" height="200" src="./images/chris_social.jpg" alt="Chris"></td>
											</tr>
											<tr>
												<td width=50% style="text-align:center"><br>Gary Stewart</td>
												<td width=50% style="text-align:center"><br>Christopher Reedijk</td>
											</tr>
											<tr>
												<td width=50% style="text-align:center">
													<br>
													<ul>
														<li>Dev Engineer</li>
														<li>Love/hate relationship with C*</li>
														<li>14 years of experience in IT</li>
														<li>@ING since: 01-01-2012</li>
													</ul>
												</td>
												<td width=50% style="text-align:center">
													<br>
													<ul>
														<li>Dev Engineer</li>
														<li>Back-end guy</li>
														<li>10 years of experience in IT</li>
														<li>@ING since: 01-01-2011</li>
													</ul>
												</td>
											</tr>
										</table>
	                    			</td>
	                    		</tr>
	                    	</table>
					</section>
				</section>


                <section>
                    <section>
                        <h2><span class="ING">3 Challenges</span></h2>
                    </section>

                    <section>
                        <p><span class="ING">challenge 1</span></p><h2>Improve <span class="ING">availability</span><br>without trading <span class="ING">consistency</span></h2>
                    </section>
                    <section>
                        <em><span class="ING">availability & consistency</span></em><br><br>
                        <h2>Consequences of not being <span class="ING">available</span></h2>
                        <img src="./images/challenge1_ING_outage.jpg" alt="ING outage">
                        <img src="./images/challenge1_ING_outage_1.jpg" alt="ING outage">
                        <br><img src="./images/challenge1_ING_outage_2.jpg" alt="ING outage">
                        <br><small>source: <a href="http://www.nu.nl" target="_blank"><span class="ING">nu.nl</span></a></small>
                    </section>
                    <section>
                        <em><span class="ING">availability & consistency</span></em><br><br>
                        <h2>Consequences of not being <span class="ING">consistent</span></h2>
                        <img src="./images/InsufficientFunds.jpg" alt="Insuffiecient funds">
                    </section>
                    <section>
                        <p><span class="ING">challenge 2</span></p><h2>Aim to be <span class="ING">easier</span> scalable<br>Changes are happening at an <span class="ING">increasing</span> pace</h2>
                    </section>
                    <section>
                        <em><span class="ING">easier scalable</span></em><br><br>
                        <h2>Stop focusing on the<br><span class="ING">expected</span> load</h2>
                        <img width=50% src="./images/web-yester.png" alt="Web yesterday">
                        <br><small>yesterday</small>
                        <br><br><small>source: <a href="http://bradfrostweb.com/blog/web/responsive-web-design-missing-the-point/" target="_blank"><span class="ING">bradfrostweb.com</span></a></small>
                    </section>
                    <section>
                        <em><span class="ING">easier scalable</span></em><br><br>
                        <h2>Start focusing on the<br><span class="ING">unexpected</span> load</h2>
                        <img width=45% src="./images/web-now.png" alt="Web now"></td>
                        <img width=45% src="./images/web-tomorrow.png" alt="Web tomorrow">
                        <br><table class="stretch">
                        <tr>
                            <td height=10% width=50% style="text-align: center;"><small>today</small></td>
                            <td height=10% width=50% style="text-align: center;"><small>tomorrow</small></td>
                        </tr>
                        <tr>
                            <td colspan=2 style="text-align: center;"><small>source: <a href="http://bradfrostweb.com/blog/web/responsive-web-design-missing-the-point/" target="_blank"><span class="ING">bradfrostweb.com</span></a></small></td>
                        </tr>
                    </table>
                    </section>
                    <section>
                        <p><span class="ING">challenge 3</span></p><h2>Adopt <span class="ING">new</span> ways of thinking<br>Become the top <span class="ING">engineering</span> company</h2>
                    </section>
                    <section>
                        <em><span class="ING">new way of thinking</span></em><br><br>
                        <h2>ING's <span class="ING">culture</span> is changing fast.<br>Waterfall to Scrum to DevOps in less than <span class="ING">2 years</span></h2>
                    </section>
                    <section>
                        <em><span class="ING">new way of thinking</span></em><br><br>
                        <p>Aim to approach problems as <span class="ING">green field</span> to understand the essence</p>
                        <p><span class="ING">"Un-learn"</span> principles that don't scale</p>
                        <p><span>Use <span class="ING">cache</span> correctly!<span class="ING"></span></span></p>
                        <p>Reduce <span class="ING">locking</span> (transaction)</p>
                        <p></p>
                    </section>
                </section>

				<section>
					<section>
						<h2><span class="ING">Apache Cassandra</span></h2>
						<br>
						<p>Created by Avinash Lakshman and Prashant Malik at Facebook</p>
						<br>
						<table width=100%>
							<tr>
								<th class="ING" width=45%>Cassandra is</th>
								<th class="ING" width=10%></th>
								<th class="ING" width=45%>Cassandra is not</th>
							</tr>
							<tr>
								<td width=50% style="vertical-align:top">
									<ul>
										<li>A distributed database</li>
										<li>Highly scalable</li>
										<li>Fault tolerant</li>
										<li>Consistency is tunable</li>
										<li>High throughput</li>
										<li>Network topology aware</li>
										<li>Multi-DC Active-Active</li>
										<li>Written in Java</li>
										<li>A column family</li>
										<li>CQL3</li>
									</ul>
								</td>
								<td width=10%>&nbsp;</td>
								<td width=50% style="vertical-align:top">
									<ul>
										<li>ACID compliant database</li>
										<li>A relational database</li>
										<li>ANSI SQL compliant</li>
										<li>A document database</li>
									</ul>
								</td>
							</tr>
						</table>
					</section>
				</section>

                <section>
                    <section>
                        <h2><span class="ING">DataStax and Cassandra</span></h2>
                        <img width=25% src="./images/cassandra.png" alt="Cassandra" style="background-color:white;">
                        <p>Founded in 2010 by Jonathan Ellis and Matt Pfeil</p>
                        <p>80% Apache Cassandra code contribution</p>
                        <p>Offer commercial support for DataStax Enterprise version of Cassandra</p>
                        <p>DataStax Enterprise integrates Search and Analytics</p>
                        <p>Head Quarter in San Francisco Bay area</p>
                        <p>EMEA office opened in March 2013</p>
                    </section>
                    <section>
                        <h2><span class="ING">Native Protocol / DataStax Drivers</span></h2>
                        <br>
                        <p>CQL3 Only</p>
                        <p>Fully asynchronous protocol, using Netty</p>
                        <p>Server notifications</p>
                        <br>
                        <p>Java, C#, Python, node.js and Ruby so far, more will be added</p>
                        <p>Many policies, including TokenAwarePolicy, DowngradeConsistencyRetryPolicy, etc...</p>
                        <p>Metrics (<a href="http://metrics.codahale.com/"><span class="ING">metrics.codahale.com</span></a>) included</p><br>
                            <pre><code data-trim contenteditable style="font-size: 18px;">
Maven:                      <dependency>
                                <groupId>com.datastax.cassandra</groupId>
                                <artifactId>cassandra-driver-core</artifactId>
                                <version>2.0.2</version>
                            </dependency>
                            </code></pre>
                    </section>
                </section>

				<section>
					<section>
						<h1><span class="ING">Cassandra Internals</span></h1>
					</section>
					<section>
						<h2><span class="ING">Tuneable Consistency</span></h2><br>
						<h4>Configureable Consistency Level (CL)<br>per read and write action</h4>
						<table>
							<tr>
								<td width=50% style="vertical-align:top">
									<span class="ING"><u>Writes</u></span><br>
									<ul>
										<small><li>Any</li>
										<li>One</li>
										<li>Two</li>
										<li>Three</li>
										<li>Quorum</li>
										<li>Local_Quorum</li>
										<li>Each_Quorum</li>
										<li>All</li></small>
									</ul>
								</td>
								<td width=50% style="vertical-align:top">
									<span class="ING"><u>Reads</u></span><br>
									<ul>
										<small><br><li>One</li>
										<li>Two</li>
										<li>Three</li>
										<li>Quorum</li>
										<li>Local_Quorum</li>
										<li>Each_Quorum</li>
										<li>All</li></small>
									</ul>
								</td>
							</tr>
						</table>
					</section>
					<section>
						<h2><span class="ING">Logical Grouping</span></h2>
						<table>
							<tr>
								<td width=50% style="vertical-align:middle">
									<p><span class="ING">Keyspace:</span> group of tables</p>
									<p><span class="ING">Table:</span> group of data</p>
									<p><span class="ING">Replication Factor:</span><br>Number of copies of data</p>
								</td>
								<td width=50% style="vertical-align:middle">
									<img width=100% src="./images/logical_grouping.png" alt="Logical Grouping" style="background-color:white;"></img>
								</td>
							</tr>
						</table>
					</section>
					<section>
						<h2><span class="ING">Cassandra Replication Strategy</span></h2>
						<table>
							<tr>
								<td width=60% style="vertical-align:middle">
									<p>Token Range 0 -> 2<small>127</small>-1 in Ring Formation</p>
									<p>Consistent Hashing Algorithm</p>
									<p>Replica nodes in clockwise</p>
									<p>Gossip protocol between nodes</p>
								</td>
								<td width=40% style="vertical-align:middle">
									<img width=100% src="./images/cassandra_replication_strategy.png" alt="Cassandra Replication Strategy" style="background-color:white;"></img>
									<small>Replication Factor (RF) = 3</small>
								</td>
							</tr>
						</table>
					</section>
					<section>
						<h2><span class="ING">Network Topology Awareness</span></h2>
						<img width=100% src="./images/network_topology_awareness.png" alt="Network Topology Awareness" style="background-color:white;"></img>
					</section>
					<section>
						<h2><span class="ING">Replication Factor and Data Consistency In a Distributed System</span></h2>
						<p>CAP – Consistency, Availability, Partition Tolerance</p>
						<p>Consistency is achieved with W + R > RF</p>
						<p>Quorum = (Integer) RF / 2 + 1</p>
						<img width=90% src="./images/quorum.png" style="background-color:white;"></img>
					</section>
					<section>
						<h2><span class="ING">Write Path</span></h2>
						<img width=100% src="./images/write_path.png" alt="Write Path" style="background-color:white;"></img>
					</section>
					<section>
						<h2><span class="ING">Read Path</span></h2>
						<img width=100% src="./images/read_path.png" alt="Read Path" style="background-color:white;"></img>
						<aside class="notes">
							Cassandra performs random reads from SSD in parallel with extremely low latency, unlike most databases. Rotational disks are not recommended. Cassandra reads, as well as writes, data by partition key, eliminating complex queries required by a relational database.
							First, Cassandra checks the Bloom filter. Each SSTable has a Bloom filter associated with it that checks the probability of having any data for the requested partition key in the SSTable before doing any disk I/O.
							If the probability is good, Cassandra checks the partition key cache and takes one of these courses of action:
							•	If an index entry is found in the cache:
							•	Cassandra goes to the compression offset map to find the compressed block having the data.
							•	Fetches the compressed data on disk and returns the result set.
							•	If an index entry is not found in the cache:
							•	Cassandra searches the partition summary to determine the approximate location on disk of the index entry.
							•	Next, to fetch the index entry, Cassandra hits the disk for the first time, performing a single seek and a sequential read of columns (a range read) in the SSTable if the columns are contiguous.
							•	Cassandra goes to the compression offset map to find the compressed block having the data.
							•	Fetches the compressed data on disk and returns the result set.
						</aside>
					</section>
				</section>			
				<section>
					<section>
						<h1><span class="ING">CQL3</span></h1>	
					</section>
					<section>
						<h2><span class="ING">Why CQL3?</span></h2><br>
						<p>Excellent language for modeling data structures</p>
						<p>Usability</p>
						<p>Readability</p>
						<p>Familiarity</p>
						<p>Programming language agnostic</p>
					</section>
					<section>
						<h2><span class="ING">Apache Thrift, Hector, Astyanax days</span></h2>
						<table height=100%>
							<tr>
								<td width=60% style="vertical-align:middle">
									<pre style="background-color:#625D5D">
Column col = 
    new Column(ByteBuffer.wrap("product".getBytes())));
col.setValue(ByteBuffer.wrap("phone".getBytes());
col.setTimestamp(System.currentTimeMillis());

ColumnOrSuperColumn c = new ColumnOrSuperColumn();
c.setColumn(col);

Mutation m = new Mutation();
m.setColumn_or_supercolumn(c);

List<Mutations> ms = new ArrayList<Mutation>();
ms.add(m);

Map<String, List<Mutations>> cf = 
    new HashMap<String, List<Mutations>>();
cf.put("products", m);

Map<ByteBuffer, Map<String, List<Mutation>>> records = 
    new HashMap<ByteBuffer, Map<String, List<Mutation>>>();
records.put(ByteBuffer.wrap("key".getBytes()), cf);
client.batch_mutate(records, consistencyLevel);
									</pre>
								</td>
								<td width=40% style="vertical-align:middle">
									<img width=100% src="./images/stress.png" style="background-color:white;"></img>
								</td>
							</tr>
						</table>
					</section>
					<section>
						<h2><span class="ING">CQL3</span></h2>
						<br>
						<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
INSERT INTO products (product_id, product) 
     VALUES (“id12321”, “phone”);
						</code></pre>
						<img width=60% src="./images/easy.png" style="background-color:white;"></img>
					</section>
                 </section>
                 <section>
                     <section>
                         <h1><span class="ING">Data Modelling</span></h1>
                     </section>
					 <section>
                         <h2><span class="ING">Objectives</span></h2>
                         <br>
                         <br>Learn basic modelling techniques
                         <br>Learn how to use Cassandra DDL (Data Definition Language)
                         <br>Learn how to use Cassandra DML (Data Manipulation Language)
                     </section>
                     <section>
                         <h2><span class="ING">Keyspace</span></h2>
                         <br>
						<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">                         
CREATE KEYSPACE "primer" 
  WITH REPLICATION = {'class'         : 'NetworkTopologyStrategy', 
                      'datacenter1'   : 3
                     };


USE primer;
				   		</code></pre>
                     </section>
                     <section>
                         <h2><span class="ING">Primary Key</span></h2>
                         <br>
                         <div style="color:#ffffff">
                             <div align="left"><p><span style="color:#ff1493">The Primary Key</span></p></div>
                             <ul>
                                 <li>The key that uniquely identifies a row</li>
                                 <li>A <span style="color:#ff1493">primary key</span> consists of:</li>
                                 <ul>
                                     <li>A (composite) <span style="color:#7cfc00">partition key</span></li>
                                     <li>One or more <span style="color:#E4F173">clustering columns</span><br>
                                         e.g. <span style="color:#ff1493">PRIMARY KEY</span> (<span style="color:#7cfc00">partition key</span>, <span style="color:#E4F173">cluster columns</span>, ...)</li>
                                 </ul>
                                 <li>The <span style="color:#7cfc00">partition key</span> determines on which node the partition resides</li>
                                 <li>Data is ordered in <span style="color:#E4F173">cluster column</span> order within the partition</li>
                             </ul>
                         </div>
                     </section>
                     <section>
                         <h2><span class="ING">Simple Table</span></h2>
                         <br>
                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY (id)  
);
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
INSERT INTO party_account (id, account, type, name) 
     VALUES ('11111', 'NL00INGB1111111111','Payment','Chris'); 
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
SELECT * 
  FROM party_account 
 WHERE id ='11111';


id    | account            | name  | type
------+--------------------+-------+---------
11111 | NL00INGB1111111111 | Chris | Payment
							</code></pre>
                                 </td>
                             </tr>
                         </table>
                     </section>
                     <section>
                         <h2><span class="ING">Simple Table - Question</span></h2>
                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top">What do you expect the output to be?
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
DROP TABLE party_account;  

CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY (id)  
);								

INSERT INTO party_account (id, account, type, name) 
     VALUES ('11111', 'NL00INGB1111111111','Payment','Chris'); 
INSERT INTO party_account (id, account, type, name) 
     VALUES ('11111', 'NL00INGB2222222222','Loan','Chris'); 
INSERT INTO party_account (id, account, type, name) 
     VALUES ('55555', 'NL00INGB5555555555','Payment', 'Gary');

SELECT * 
  FROM party_account 
 WHERE id in ('11111','55555');
									</code></pre>
                                 </td>
                             </tr>
							 <tr>
							  <td>
                              	<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
id    | account            | name  | type
------+--------------------+-------+---------
11111 | NL00INGB2222222222 | Chris | Loan
55555 | NL00INGB5555555555 |  Gary | Payment
                              	</code></pre>
                             </tr>
                            </td>
                         </table>
                     </section>
                     <section>
                         <h2><span class="ING">Composite Partition Key</span></h2>
                         <br>
                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top"><p>Note the extra brackets in the primary key!</p>
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY ( ( id , account ) )
);
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
INSERT INTO party_account (id, account, type, name) 
     VALUES ('11111', 'NL00INGB1111111111','Payment','Chris'); 

INSERT INTO party_account (id, account, type, name) 
     VALUES ('11111', 'NL00INGB2222222222','Loan','Chris'); 
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
SELECT * 
  FROM party_account 
 WHERE id = '11111' 
   AND account IN ('NL00INGB1111111111','NL00INGB2222222222');


id    | account            | name  | type
------+--------------------+-------+---------
11111 | NL00INGB1111111111 | Chris | Payment
11111 | NL00INGB2222222222 | Chris | Loan
							</code></pre>
                                 </td>
                             </tr>
                         </table>
                     </section>
                     <section>
                         <h2><span class="ING">Composite Partition Key - Question</span></h2>
                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY ( ( id , account ) )
);
									</code></pre>
                                 </td>
                             </tr>
							 <tr>
							  <td>Will the following query work?
                              	<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">

SELECT * 
  FROM party_account 
 WHERE id = '11111' 
					          	</code></pre>
                             </tr>
                            </td>
                         </table>
                     </section>
                     <section>
                         <h2><span class="ING">Clustering Columns</span></h2>
                         <br>
                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top"><p></p>
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY ( id , account )
);
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
INSERT INTO party_account (id, account, type, name) 
     VALUES ('11111', 'NL00INGB1111111111','Payment','Chris'); 

INSERT INTO party_account (id, account, type, name) 
     VALUES ('11111', 'NL00INGB2222222222','Loan','Chris'); 
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
SELECT * 
  FROM party_account 
 WHERE id = '11111' ;


id    | account            | name  | type
------+--------------------+-------+---------
11111 | NL00INGB1111111111 | Chris | Payment
11111 | NL00INGB2222222222 | Chris | Loan
							</code></pre>
                                 </td>
                             </tr>
                         </table>
                     </section>
                     <section>
                         <h2><span class="ING">(Clustering) Order By</span></h2>
                         <br>
                         <table>
                             <tr>
                                 <td width=45% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
SELECT * 
  FROM party_account 
 WHERE id = '11111'
 ORDER BY account DESC;
									</code></pre>
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY ( id , account )
) WITH CLUSTERING ORDER BY (account DESC);
									</code></pre>
                                 </td>
                                 <td width=55% style="vertical-align:top">
                                     <p>Partition keys are not ordered!</p>
                                     <p>You can only order by a clustering column</p>
                                     <p>Data will ordered ASCending by default</p>
                                 </td>
                             </tr>
                         </table>
                     </section>
                     <section>
                         <h2><span class="ING">Clustering Columns - Question</span></h2>
                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY ( id , account )
);
									</code></pre>
                                 </td>
                             </tr>
							 <tr>
							  <td>Will the following query work?
                              	<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">

SELECT * 
  FROM party_account 
 WHERE id = '11111' 
   AND account IN ('NL00INGB1111111111','NL00INGB2222222222');
					          	</code></pre>
                             </tr>
                            </td>
                         </table>
                     </section>
                     <section>
                         <h2><span class="ING">Static Columns</span></h2>
                         <p>Introduced in Cassandra 2.0</p>
                         <br>
                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top"><p></p>
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar STATIC, 
    PRIMARY KEY ( id , account )
);
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
INSERT INTO party_account (id, account, type, name) 
     VALUES ('11111', 'NL00INGB1111111111','Payment','Chris'); 

INSERT INTO party_account (id, account, type ) 
     VALUES ('11111', 'NL00INGB2222222222','Loan'); 
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
SELECT * 
  FROM party_account 
 WHERE id = '11111' ;


id    | account            | name  | type
------+--------------------+-------+---------
11111 | NL00INGB1111111111 | Chris | Payment
11111 | NL00INGB2222222222 | Chris |    Loan

							</code></pre>
                                 </td>
                             </tr>
                         </table>
                     </section>
                     <section>
                         <h2><span class="ING">Updates versus Inserts</span></h2>
                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
INSERT INTO party_account (id, account, type, name) 
     VALUES ('11111','NL00INGB2222222222','Payment','Chris'); 


UPDATE party_account 
   SET type = 'Payment',
       name = 'Chris'
 WHERE id = '11111' 
   AND account = 'NL00INGB2222222222';
									</code></pre>
                                 </td>
                             </tr>
                            </td>
                              <tr>
                                 <td width=100% style="vertical-align:top">
                                 <br>Inserts and Updates are almost always the same
                                 <br>Updates will insert when row does not exist!
                                 <br>Unique constraint error do not exist in Cassandra!
                                </td>
                             </tr>
                         </table>
                     </section>
					 <section>
                        <h2><span class="ING">Data Types</span></h2>
                        <img width=50% src="./images/data_types.png" style="background-color:white;"></img>
                    </section>
                     <section>
                         <h2><span class="ING">Collections</span></h2>
                         <br>
                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top"><p></p>
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE collections_example (
    id            int PRIMARY KEY,
    set_example   set&lt;text>,
    list_example  list&lt;text>,
    map_example   map&lt;int, text>,
);
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
INSERT INTO collections_example (id, set_example, list_example, map_example)
     VALUES (1, {'set A', 'setB'}, ['list A', 'list B'], { 1  : 'map A', 2  : 'map B'});


UPDATE collections_example
  SET set_example = set_example + {'set C'} 
WHERE id = 1;
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
SELECT * 
  FROM collections_example 
 WHERE id = 1 ;


id | list_example         | map_example              | set_example
---+----------------------+--------------------------+----------------------------
 1 | ['list A', 'list B'] | {1: 'map A', 2: 'map B'} | {'set A', 'set C', 'setB'}
							</code></pre>
                                 </td>
                             </tr>
                         </table>
                     </section>
                     <section>
                         <h2><span class="ING">Batches</span></h2>
                         <br>

                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top"><p></p>
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
BEGIN BATCH

  INSERT INTO party_account (id, account, type, name) 
       VALUES ('11111', 'NL00INGB1111111111','Payment','Chris'); 
  INSERT INTO party_account (id, account, type, name) 
       VALUES ('11111','NL00INGB2222222222','Payment','Chris'); 

APPLY BATCH;
									</code></pre>
                                 </td>
                             </tr>
							  <tr>
                                 <td width=100% style="vertical-align:top">
                                 <br>Use batches for atomicity not performance!
                                 <br>Use asynchronous queries for performance!
                                </td>
                             </tr>
                         </table>
                     </section>            
                     <section>
                         <h2><span class="ING">Time to Live (TTL)</span></h2>
                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY ( id , account )
);
									</code></pre>
                                 </td>
                             </tr>
							 <tr>
							  <td>
                              	<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
INSERT INTO party_account (id, account, type, name) 
     VALUES ('11111', 'NL00INGB2222222222','Loan','Chris') 
      USING TTL 3600; // Expires data in one hour
					          	</code></pre>
                             </tr>
                            </td>
                         </table>
                     </section>
                     <section>
                         <h2><span class="ING">Time to Live (TTL) - Question</span></h2>
                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY ( id , account )
);
									</code></pre>
                                 </td>
                             </tr>
							 <tr>
							  <td>What happens when I do the following?
                              	<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
INSERT INTO party_account (id, account, type, name) 
     VALUES ('11111', 'NL00INGB2222222222','Loan','Chris'); 

INSERT INTO party_account (id, account, name) 
     VALUES ('11111', 'NL00INGB2222222222','Chris') 
      USING TTL 10; 
					          	</code></pre>
                             </tr>
                            </td>
                                                         <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
id    | account            | name  | type
------+--------------------+-------+---------
11111 | NL00INGB2222222222 |  null |    Loan
							</code></pre>
                                 </td>
                             </tr>
                         </table>
                     </section>
                    <section>
                        <h2><span class="ING">Counters</span></h2>
						<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE party_counter (
   id           varchar,
   num_accounts counter,
   PRIMARY KEY (id)
);
						</code></pre>
						<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
UPDATE party_counter 
   SET num_accounts = num_accounts + 1
 WHERE id = '11111' 
 						</code></pre>
 						<li>Counter tables can only consist of primary key and counters</li>
 						<li>Warning - not idem-potent</li>
                    </section>
                     <section>
                         <h2><span class="ING">Lightweight Transactions</span></h2>
                         <p>Introduced in Cassandra 2.0</p>
                         <table width=100%>
                             <tr>
                                 <td width=100% style="vertical-align:top"><p></p>
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY ( id , account )
);

INSERT INTO party_account (id, account, type, name) 
     VALUES ('11111', 'NL00INGB1111111111','Payment','Chris'); 
									</code></pre>
                                 </td>
                                 <td width=0%>
                                 </td>
                             </tr>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
UPDATE party_account 
   SET name = 'Gary'
 WHERE id = '11111' 
   AND account = 'NL00INGB1111111111'
    IF name = 'Chris'; 

 [applied]
-----------
      True
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td width=100% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
UPDATE party_account 
   SET name = 'Gary'
 WHERE id = '11111' 
   AND account = 'NL00INGB1111111111'
    IF name = 'Chris'; 

 [applied] | name
-----------+------
     False | Gary

									</code></pre>
                                 </td>
                             </tr>
                         </table>
                     </section>

                     <section>
                         <h2><span class="ING">De-normalize</span></h2>
                         <br>
                         <table width=100%>
                             <tr>
                                 <th class="ING">Don't do this</th>
                                 <th class="ING">Do this instead</span></th>
                             </tr>
                             <tr>
                                 <td width=45% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY ( id , account )
);

CREATE INDEX party_account_name ON 
    party_account (name);

CREATE INDEX party_account_type ON 
    party_account (type);

SELECT *
  FROM party_account 
 WHERE name='Gary'
   AND type ='Loan'
 ALLOW FILTERING;
									</code></pre>
                                 </td>
                                 <td width=45% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">

CREATE TABLE party_account (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY ( id , account )
);


CREATE TABLE party_account_by_name_type (
    id        varchar,
    account   varchar,
    type      varchar,
    name      varchar, 
    PRIMARY KEY ( (name , type), id )
);
									</code></pre>
                                 </td>
                             </tr>
                         </table>
                     </section> 
                                         <section>
                         <h2><span class="ING">Time Series</span></h2>
                         <br>
                         <table width=100%>
                             <tr>
                                 <td width=40% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
CREATE TABLE sensor_data (
 sensor_id  int,
 date       varchar,
 time       timeuuid,
 value      int,
 PRIMARY KEY((sensor_id, date), time)
) 
WITH CLUSTERING ORDER BY (time DESC);
									</code></pre>
                                 </td>
                                 <td width=60% style="vertical-align:top">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
INSERT INTO sensor_data (sensor_id, date, time, value)
VALUES (1, '20130908', 1883-11e3-8ffd-0800200c9a66,432)
 USING TTL 604800;
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td colspan="2" style="vertical-align:top; margin-left:auto; margin-right:auto">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
SELECT time, value, TTL (value) 
  FROM sensor_data
 WHERE sensor_id = 1 AND date = '20130908'
   AND time > maxTimeuuid('2013-09-08 10:05+0000')
   AND time < minTimeuuid('2013-09-08 15:00+0000');
									</code></pre>
                                 </td>
                             </tr>
                             <tr>
                                 <td colspan="2" style="vertical-align:top; margin-left:auto; margin-right:auto">
									<pre><code class="sql" data-trim contenteditable style="font-size: 16px;">
time                        | value | ttl(value)
----------------------------+-------+------------
1883-11e3-8ffd-0800200c9a66 |   432 |     604257
1887-11e3-8ffd-0800200c9a66 |   433 |     604452
									</code></pre>
                                 </td>
                             </tr>
                         </table>
                     </section> 
                    <section>
                         <h2><span class="ING">Performance<br>considerations</span></h2>
                         <br>
                         <p>The best queries are in a single partition.</p>
                         <small>i.e. WHERE partition key = <something></small>
                         <p>Queries that span multiple partitions are <span style="color:red">s-l-o-w</span></p>
                         <small>i.e. WHERE partition key IN ( <something> , <something> , ... );</small>
                         <p>Queries that span multiple cluster columns are <span style="color:green">fast</span></p>
                        <small>i.e. WHERE partition key = <something> and clustering key = <something></small>
						<p>"Table scan" - <span style="color:green">slow</span>! (Limited to 10,000 rows by default)</p>
                        <small>Use LIMIT keyword to choose fewer or more rows</small>
                        <p>Collections - Often more efficient to denormalise further especially for larger data sets</p>
                        <small>Also favour sets over list</small>
						<p>Use lightweight transactions only where necessary</p>
						<small>Great for 1% of your application</small>
                    </section>


                     <section>
                         <h2><span class="ING">Tracing</span></h2>
                         <br>
<pre><code class="sql" data-trim contenteditable style="font-size: 15px;">
cqlsh:primer> tracing on;
select * from party_account where id ='11111'  ;
...
activity                                                       | timestamp    | source    | source_elapsed
---------------------------------------------------------------+--------------+-----------+----------------
                                            execute_cql3_query | 05:30:05,777 | 127.0.0.1 |              0
        Parsing select * from party_account where id ='11111'; | 05:30:05,777 | 127.0.0.1 |            199
                                           Preparing statement | 05:30:05,777 | 127.0.0.1 |            518
                                 Sending message to /127.0.0.2 | 05:30:05,780 | 127.0.0.1 |           3113
...                       
             Executing single-partition query on party_account | 05:30:05,799 | 127.0.0.2 |          17915
                              Enqueuing response to /127.0.0.1 | 05:30:05,799 | 127.0.0.3 |          16772
                                  Acquiring sstable references | 05:30:05,799 | 127.0.0.2 |          17940
                                   Merging memtable tombstones | 05:30:05,799 | 127.0.0.2 |          17982
Skipped 0/0 non-slice-. sstables, included 0 due to tombstones | 05:30:05,799 | 127.0.0.2 |          18038
                    Merging data from memtables and 0 sstables | 05:30:05,799 | 127.0.0.2 |          18052
                            Read 3 live and 0 tombstoned cells | 05:30:05,799 | 127.0.0.2 |          18132
...
                              Message received from /127.0.0.3 | 05:30:05,822 | 127.0.0.1 |          45282
                           Processing response from /127.0.0.3 | 05:30:05,822 | 127.0.0.1 |          45338
                                              Request complete | 05:30:05,822 | 127.0.0.1 |          45694
							</code></pre>
                     </section>
				</section>

                <section>
                    <em><span class="ING">all challenges appear again...</span></em><br><br>
                    <p>Improve <span class="ING">availability</span></p>
                    <p>Aim to be <span class="ING">scalable</span></p>
                    <p>Adopt <span class="ING">new</span> ways of thinking</p>
                </section>
                <section>
                    <section>
                        <h2><span class="ING">3 Facts</span></h2>
                    </section>
                    <section>
                        <p><span class="ING">fact 1</span></p><h2><span class="ING">Availability</span> is easier</h2>
                    </section>
                    <section>
                        <em><span class="ING">availability is easier, because</span></em><br><br>
                        <h2><span class="ING">Masterless</span> architecture</h2>
                        <p><span class="ING">No outages</span> in contrast to master-slave architecture</p>
                        <p>This does make C* <span class="ING">chatty</span></p>
                    </section>
                    <section>
                        <em><span class="ING">availability is easier, because</span></em><br><br>
                        <h2><span class="ING">Replication</span> of data</h2>
                        <p>Replication factor is <span class="ING">configurable</span> per keyspace</p>
                        <p>Increasing nodes <span class="ING">does not</span> mean higher availability<br>Increasing the replication factor <span class="ING">does</span></p>
                    </section>
                    <section>
                        <p><span class="ING">fact 2</span></p><h2><span class="ING">Performance</span> is easier</h2>
                    </section>
                    <section>
                        <em><span class="ING">performance is easier, and</span></em><br><br>
                        <h2>Solve your <span class="ING">reads</span> with your <span class="ING">writes</span></h2>
                        <p><span class="ING">De-normalization</span> is acceptable for solving reads</p>
                    </section>
                    <section>
                        <em><span class="ING">performance is easier, but</span></em><br><br>
                        <h2>Know your <span class="ING">partitions</span></h2>
                        <p><span class="ING">Large</span> partitions will hurt!</p>
                        <img src="./images/partitioning_table.jpg" alt="Partitioning">
                    </section>
                    <section>
                        <em><span class="ING">performance is easier, because</span></em><br><br>
                        <h2><span class="ING">Linear</span> scalable</h2>
                        <p>Adding nodes will increase your throughput through <span class="ING">sharding</span></p>
                        <img width=50% src="./images/linear_scalable.jpg" alt="Linear scalability">
                        <br><br><small>source: <a href="http://www.datastax.com/wp-content/uploads/2013/02/WP-Benchmarking-Top-NoSQL-Databases.pdf" target="_blank"><span class="ING">Datastax</span></a></small>
                    </section>
                    <section>
                        <p><span class="ING">fact 3</span></p><h2><span class="ING">Consistency</span> is harder</h2>
                    </section>
                    <section>
                        <em><span class="ING">consistency is harder, and</span></em><br><br>
                        <h2>Application <span class="ING">developer</span> has much more responsibility</h2>
                        <p>Focus on the <span class="ING">data model</span> and the <span class="ING">flow</span> of data is key</p>
                        <p><span class="ING">noSQL</span> versus <span class="ING">SQL</span></p>
                    </section>
                    <section>
                        <em><span class="ING">consistency is harder, because</span></em><br><br>
                        <h2>CAP theorem</h2>
                        <p><span class="ING">Consistency</span> (all nodes see the same data at the same time)</p>
                        <p><span class="ING">Availability</span> (a guarantee that every request receives a response about whether it was successful or failed)</p>
                        <p><span class="ING">Partition tolerance</span> (the system continues to operate despite arbitrary message loss or failure of part of the system)</p>
                    </section>
                    <section>
                        <em><span class="ING">consistency is harder, because</span></em><br><br>
                        <h2>Transactions and queuing are <span class="ING">anti-patterns</span></h2>
                        <p>C* v2.0 <span class="ING">reduces</span> the complexity by using lightweight transactions (paxos)</p>
                    </section>
                </section>
                <section>
                    <em><span class="ING">all facts appear...</span></em><br><br>
                    <p><span class="ING">Availability</span> is easier<span> | <span class="ING">challenge 1: </span> availability & consistency</span></p>
                    <p><span class="ING">Performance</span> is easier<span > | <span class="ING">challenge 2</span> easier scalable</span></p>
                    <p ><span class="ING">Consistency</span> is harder<span> | <span class="ING">challenge *</span> availability & consistency, easier scalable, new way of thinking</span></p>
                    <br><em ><span class="ING">all challenges covered...</span></em>
                </section>

                <section>
	                <section>
	                    <h2><span class="ING">C*@ING</span></h2>
	                    <table width=100% style="font-size: 22px">
	                    	<tr style="border-bottom: 3px solid #ff6600;">
	                    		<th style="font-size: 30px" width=30%><span class="ING">project<br></span></th>
	                    		<th style="font-size: 30px" width=35%><span class="ING">use case<br></span></th>
	                    		<th style="font-size: 30px" width=35%><span class="ING">status<br></span></th>
	                    	</tr>
							<tr>
		                    	<td style="background-color: #625D5D;">Betelgeuze</td>
		                    	<td style="background-color: #625D5D;">Cache of Customer Data (KRO)</td>
		                    	<td style="background-color: #625D5D;">September 2014 in PRD</td>
		                    </tr>
		                    <tr>
		                    	<td>OI: Financial Fit</td>
		                    	<td>SOR for soft data</td>
		                    	<td>September 2014 in PRD</td>
		                    </tr>
		                    <tr>
		                    	<td style="background-color: #625D5D;">RTPE</td>
		                    	<td style="background-color: #625D5D;">New payments engine for on-us payments</td>
		                    	<td style="background-color: #625D5D;">February 2015 in PRD</td>
		                    </tr>
							<tr>
		                    	<td>Faster Than Light</td>
		                    	<td>Cache of Customer Data (MDM)</td>
		                    	<td>PoC</td>
		                    </tr>
		                    <tr>
		                    	<td style="background-color: #625D5D;">Ideal,<br>Sales Support,<br>NGINX,<br>...</td>
		                    	<td style="background-color: #625D5D;">Session Management</td>
		                    	<td style="background-color: #625D5D;">In DEV</td>
		                    </tr>
		                    <tr>
		                    	<td>Ideal</td>
		                    	<td>Order Management</td>
		                    	<td>Product Backlog</td>
		                    </tr>
		                    <tr>
		                    	<td style="background-color: #625D5D;">Credit Cards</td>
		                    	<td style="background-color: #625D5D;">Cache external data</td>
		                    	<td style="background-color: #625D5D;">Awaiting budget</td>
		                    </tr>
		                    <tr>
		                    	<td>Availability Dashboard</td>
		                    	<td>Time series</td>
		                    	<td>In DEV</td>
		                    </tr>
		                    <tr>
		                    	<td style="background-color: #625D5D;">Realtime Account Forecasting</td>
		                    	<td style="background-color: #625D5D;">Cache of SAM data</td>
		                    	<td style="background-color: #625D5D;">PoC</td>
		                    </tr>
		                </table>
	                </section>
	            </section>

                <section>
	                <section>
	                    <h2><span class="ING">3 Questions - Bonus</span></h2>
	                </section>
                    <section>
                        <p><span class="ING">question 1</span></p><h2>What <span class="ING">risks</span> do we have with<br><span class="ING">2 DC's</span> and using Write/Read CL of <span class="ING">LOCAL_QUORUM</span>?</h2>
                        <img src="./images/question1.jpg" alt="Question 1">
                    </section>
                    <section>
                        <h2><span class="ING">Split-brain</span></h2>
                        <img src="./images/split_brain.jpg" alt="Split brain">
                        <p>Who wins? <span class="ING">Neither</span> side knows the other side!</p>
                    </section>
                    <section>
                        <h2>CAP theorem - <span class="ING">choose</span> wisely</h2>
                        <p>Use QUORUM but <span class="ING">risk availability</span><br>when there are issues with the WAN link</p>
                        <p>Arrange a third DC... <span class="ING">&euro;&euro;&euro;</span></p>
                        <p>Applications apply DC stickiness<br>whilst processing data which <span class="ING">increases complexity</span></p>
                    </section>
                    <section>
                        <p><span class="ING">question 2</span></p><h2>Does QUORUM read and QUORUM write <span class="ING">guarantee</span> consistency?</h2>
                    </section>
                    <section>
                        <h2><span class="ING">No</span> - it gives strong consistency</h2>
                        <p class="fragment"><span class="ING">NTP</span> must be set-up correctly
                            <br>Know your <span class="ING">flow</span> of data
                            <br>Model as <span class="ING">idem-potent-ly</span> as possible
                            <br><img src="./images/timesync_issue.jpg" alt="NTP issue"></p>
                    </section>
                    <section>
                        <p><span class="ING">question 3</span></p><h2>Will C* solve <span class="ING">all</span> your IT issues?</h2>
                    </section>
                    <section>
                        <h2><span class="ING">No</span> - but it will help solve a lot of your problems</h2>
                        <p >Performance and availability are <span class="ING">tuneable</span> based on needs and costs</p>
                        <p >Consistency is solved by <span class="ING">design</span> and knowing the <span class="ING">flow</span> of data</p>
                        <p >Going from SQL to noSQL is a <span class="ING">paradigm</span> shift</p>
                        <p ><span class="ING">Skills</span> are not readily available</p>
                        <p>Some issues are better solved by <span class="ING">relational</span> databases</p>
                    </section>
                </section>

				<section>
					<p>Thank you</p>
					<em>...graceful bow</em>
					<br><br><br>
					Contact<br>	
					<a href="mailto:christopher.reedijk@ing.nl"><span class="ING">christopher.reedijk@ing.nl</span></a><br>
					<a href="mailto:gary.stewart@ing.nl"><span class="ING">gary.stewart@ing.nl</span></a><br><br>
					<!--<em>We're hiring!</em><br>-->
					<img src="./images/ing-logo.gif" alt="ING">
				</section>
				
			</div>					
		</div>
		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // none/fade/slide/convex/concave/zoom

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>
	</body>
</html>
